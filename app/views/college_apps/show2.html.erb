
  <!-- HTML5 Shiv and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->


<div class="wrapper">
  <div class="container">

    <!-- Page-Title -->
    <div class="row">
      <div class="col-sm-12">
        <h4 class="page-title">College application for <%= @college_app.college.name %></h4>
            <p><%= @college_app.college.address %></p>
            <p><%= @college_app.college.website %></p>
      </div>
    </div>


    <div class="row">
      <div class="col-lg-4">
        <div class="card-box">
          <div class="dropdown pull-right">
            <a href="#" class="dropdown-toggle card-drop" data-toggle="dropdown"
               aria-expanded="false">
              <i class="zmdi zmdi-more-vert"></i>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="#">Action</a></li>
              <li><a href="#">Another action</a></li>
              <li><a href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a href="#">Separated link</a></li>
            </ul>
          </div>

          <h4 class="header-title m-t-0">Tasks</h4>


          <div class="row text-center m-t-30">
            <div class="col-xs-6">
              <h3 data-plugin="counterup">8,459</h3>
              <p class="text-muted">Total Tasks</p>
            </div>
            <div class="col-xs-6">
              <h3 data-plugin="counterup">584</h3>
              <p class="text-muted">Open Tasks</p>
            </div>
          </div>

          <div class="text-center m-t-10">
            <div id="morris-donut-example" style="height: 245px;"></div>
            <ul class="list-inline chart-detail-list m-b-0">
              <li>
                <h5><i class="fa fa-circle m-r-5" style="color: #da5461;"></i>Not Started</h5>
              </li>
              <li>
                <h5><i class="fa fa-circle m-r-5" style="color: #fe8995;"></i>Pending</h5>
              </li>
            </ul>
          </div>

        </div>
      </div><!-- end col -->

      <div class="col-lg-4">
        <div class="card-box">
          <div class="dropdown pull-right">
            <a href="#" class="dropdown-toggle card-drop" data-toggle="dropdown"
               aria-expanded="false">
              <i class="zmdi zmdi-more-vert"></i>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="#">Action</a></li>
              <li><a href="#">Another action</a></li>
              <li><a href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a href="#">Separated link</a></li>
            </ul>
          </div>
          <h4 class="header-title m-t-0">Total Work Left</h4>

          <div class="row text-center m-t-30">
            <div class="col-xs-4">
              <h3 data-plugin="counterup">1,507</h3>
              <p class="text-muted">Tasks To Do</p>
            </div>
            <div class="col-xs-4">
              <h3 data-plugin="counterup">916</h3>
              <p class="text-muted">Pending </p>
            </div>
            <div class="col-xs-4">
              <h3 data-plugin="counterup">22</h3>
              <p class="text-muted">Not started</p>
            </div>
          </div>

          <div id="morris-bar-example" style="height: 280px;" class="m-t-10"></div>
        </div>
      </div><!-- end col -->

      <div class="col-lg-4">
        <div class="card-box">
          <div class="dropdown pull-right">
            <a href="#" class="dropdown-toggle card-drop" data-toggle="dropdown"
               aria-expanded="false">
              <i class="zmdi zmdi-more-vert"></i>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="#">Action</a></li>
              <li><a href="#">Another action</a></li>
              <li><a href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a href="#">Separated link</a></li>
            </ul>
          </div>
          <h4 class="header-title m-t-0">Total Progress</h4>

          <div class="row text-center m-t-30">
            <div class="col-xs-6">
              <h3 data-plugin="counterup">7,653</h3>
              <p class="text-muted">Total Done</p>
            </div>
            <div class="col-xs-6">
              <h3 data-plugin="counterup">852</h3>
              <p class="text-muted">Pending Tasks</p>
            </div>
          </div>

          <div id="morris-line-example" style="height: 280px;" class="m-t-10"></div>
        </div>
      </div><!-- end col -->

    </div>
    <!-- end row -->


    <div class="row">
      <div class="col-lg-4">
        <div class="card-box">
          <h4 class="header-title m-t-0 m-b-30">Add a task</h4>

          <div class="inbox-widget nicescroll" style="height: 315px;">
              <% apps_path = current_user.is_counselor ? student_college_app_tasks_path(college_app_id: @college_app.id) : college_app_tasks_path(college_app_id: @college_app.id) %>
              <%= form_for([@college_app, @new_task], url:"#{apps_path}", method: :post) do |f| %>
              <div class="inbox-item">
              <%= f.text_area :name, placeholder: "describe a task" %>
              </div>
              <div class="inbox-item">
              <p>Due date:</p> <%= f.date_field :due_date, as: :date_time_picker%>
              </div>
              <div class="inbox-item">
              Attachment: <%= f.file_field :document %>
              <%= f.hidden_field :document_cache %>
              </div>
              <div class="inbox-item">
              <%= f.submit %>
              </div>
            <% end %>
          </div>
        </div>
      </div><!-- end col -->

      <div class="col-lg-8">
        <div class="card-box">
          <h4 class="header-title m-t-0 m-b-30">Application Tasks</h4>
      <!-- tasks table -->
          <div class="table-responsive">
            <table class="table">
              <thead>
              <tr>
                <th>Task Name</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Attachments</th>
              </tr>
              </thead>
              <tbody>
              <% tasks_chronological = @college_app.tasks.order(:due_date) %>
              <% tasks_chronological.each do |task| %>
                <tr>
                  <td><%= task.name %></td>
                  <td><%= task.due_date.strftime("%d / %m / %Y") %></td>
                  <!-- task status buttons -->

                  <% if task.status =="approved" %>
                  <td><div id="task<%=task.id -%>"><span class="btn btn-rec-green-sm">Approved</span></div></td>

                  <% elsif task.status == "pending" && current_user.is_counselor %>
                  <td><div id="task<%=task.id -%>">
                    <%= button_to "Pending", approve_student_college_app_task_path(student_id: @student.id, college_app_id: @college_app.id, id: task.id), class:"btn btn-rec-yellow-sm", remote: true%>
                    </div></td>

                  <% elsif task.status == "pending" && !current_user.is_counselor %>
                  <td><div id="task<%=task.id -%>"><span class="btn btn-rec-yellow-sm">Pending</span></div></td>

                  <% elsif task.status =="not done" && current_user.is_counselor %>
                  <td><div id="task<%=task.id -%>">
                    <%= button_to "Not started", approve_student_college_app_task_path(student_id: @student.id, college_app_id: @college_app.id, id: task.id), class:"btn btn-rec-danger-sm", remote: true%>
                  </div></td>

                  <% elsif task.status =="not done" && !current_user.is_counselor %>
                  <td><div id="task<%=task.id -%>">
                    <%= button_to "Not started", pending_college_app_task_path(student_id: @student.id, college_app_id: @college_app.id, id: task.id), class:"btn btn-rec-danger-sm", remote: true%>
                  </div></td>
                  <% end %>

                <% if task.no_document && current_user.is_counselor %>
                  <td>
                  <%= form_for([@college_app, task], method: :put) do |f| %>
                  <%= f.file_field :document, input_html: { hidden: true }, label: 'Upload Attachment' %>
                  <%= f.hidden_field :document_cache %>
                  <%= f.submit id:"upload", style: "display: none;" %>
                  <% end %>
                 </td>
                 <% else %>
                 <td>
                  <%= link_to '<i class="fa fa-download icon"></i>'.html_safe, task.document.url %>
                 </td>
                </tr>
                <% end %>
              <% end %>
              </tbody>
            </table>
          </div>
          </div>
        </div>
      </div><!-- end col -->

    </div>
    <!-- end row -->



  </div>
  <!-- end container -->



  <!-- Right Sidebar -->
  <div class="side-bar right-bar">
    <a href="javascript:void(0);" class="right-bar-toggle">
      <i class="zmdi zmdi-close-circle-o"></i>
    </a>
    <h4 class="">Notifications</h4>
    <div class="notification-list nicescroll">
      <ul class="list-group list-no-border user-list">
        <li class="list-group-item">
          <a href="#" class="user-list-item">
            <div class="avatar">
              <img src="assets/images/users/avatar-2.jpg" alt="">
            </div>
            <div class="user-desc">
              <span class="name">Michael Zenaty</span>
              <span class="desc">There are new settings available</span>
              <span class="time">2 hours ago</span>
            </div>
          </a>
        </li>
        <li class="list-group-item">
          <a href="#" class="user-list-item">
            <div class="icon">
              <i class="zmdi zmdi-account"></i>
            </div>
            <div class="user-desc">
              <span class="name">New Signup</span>
              <span class="desc">There are new settings available</span>
              <span class="time">5 hours ago</span>
            </div>
          </a>
        </li>
        <li class="list-group-item">
          <a href="#" class="user-list-item">
            <div class="icon">
              <i class="zmdi zmdi-comment"></i>
            </div>
            <div class="user-desc">
              <span class="name">New Message received</span>
              <span class="desc">There are new settings available</span>
              <span class="time">1 day ago</span>
            </div>
          </a>
        </li>
        <li class="list-group-item">
          <a href="#" class="user-list-item">
            <div class="avatar">
              <img src="assets/images/users/avatar-3.jpg" alt="">
            </div>
            <div class="user-desc">
              <span class="name">James Anderson</span>
              <span class="desc">There are new settings available</span>
              <span class="time">2 days ago</span>
            </div>
          </a>
        </li>
        <li class="list-group-item active">
          <a href="#" class="user-list-item">
            <div class="icon">
              <i class="zmdi zmdi-settings"></i>
            </div>
            <div class="user-desc">
              <span class="name">Settings</span>
              <span class="desc">There are new settings available</span>
              <span class="time">1 day ago</span>
            </div>
          </a>
        </li>

      </ul>
    </div>
  </div>
  <!-- /Right-bar -->

</div>


<script type="text/javascript">

  /**
   * Theme: Flacto Admin Template
   * Author: Coderthemes
   * Dashboard
   */

  !function($) {
    "use strict";

    var Dashboard1 = function() {
      this.$realData = []
    };

    //creates Bar chart
    Dashboard1.prototype.createBarChart  = function(element, data, xkey, ykeys, labels, lineColors) {
      Morris.Bar({
        element: element,
        data: data,
        xkey: xkey,
        ykeys: ykeys,
        labels: labels,
        hideHover: 'auto',
        resize: true, //defaulted to true
        gridLineColor: '#eeeeee',
        barSizeRatio: 0.2,
        barColors: lineColors
      });
    },

      //creates line chart
        Dashboard1.prototype.createLineChart = function(element, data, xkey, ykeys, labels, opacity, Pfillcolor, Pstockcolor, lineColors) {
          Morris.Line({
            element: element,
            data: data,
            xkey: xkey,
            ykeys: ykeys,
            labels: labels,
            fillOpacity: opacity,
            pointFillColors: Pfillcolor,
            pointStrokeColors: Pstockcolor,
            behaveLikeLine: true,
            gridLineColor: '#eef0f2',
            hideHover: 'auto',
            resize: true, //defaulted to true
            pointSize: 0,
            lineColors: lineColors
          });
        },

      //creates Donut chart
        Dashboard1.prototype.createDonutChart = function(element, data, colors) {
          Morris.Donut({
            element: element,
            data: data,
            resize: true, //defaulted to true
            colors: colors,
            backgroundColor: '#fff'
          });
        },


        Dashboard1.prototype.init = function() {

          //creating bar chart
          var $barData  = [
            { y: '2010', a: 75 },
            { y: '2011', a: 42 },
            { y: '2012', a: 75 },
            { y: '2013', a: 38 },
            { y: '2014', a: 19 },
            { y: '2015', a: 93 },
            { y: '2016', a: 50 }
          ];
          this.createBarChart('morris-bar-example', $barData, 'y', ['a'], ['Statistics'], ['#fe6271']);

          //create line chart
          var $data  = [
            { y: '2008', a: 50, b: 0 },
            { y: '2009', a: 75, b: 50 },
            { y: '2010', a: 30, b: 80 },
            { y: '2011', a: 50, b: 50 },
            { y: '2012', a: 75, b: 10 },
            { y: '2013', a: 50, b: 40 },
            { y: '2014', a: 75, b: 50 },
            { y: '2015', a: 100, b: 70 }
          ];
          this.createLineChart('morris-line-example', $data, 'y', ['a','b'], ['Series A','Series B'],['0.9'],['#ffffff'],['#999999'], ['#ddd','#fe8995']);

          //creating donut chart
          var $donutData = [
            {label: "Open Tasks", value: 12},
            {label: "Pending Tasks", value: 30},
            {label: "Approved Tasks", value: 20}
          ];
          this.createDonutChart('morris-donut-example', $donutData, ['#fe8995', "#fe6271","#ddd"]);
        },
      //init
        $.Dashboard1 = new Dashboard1, $.Dashboard1.Constructor = Dashboard1
  }(window.jQuery),

//initializing
      function($) {
        "use strict";
        $.Dashboard1.init();
      }(window.jQuery);
</script>
